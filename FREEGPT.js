const FREEGPT = {version:"1.1.0",proxies:["https://corsproxy.io/?","https://api.allorigins.win/get?url="],proxyUsed:0,response:null,APIS:["https://chatbot-ji1z.onrender.com/chatbot-ji1z","https://chatgptspanish.org/wp-admin/admin-ajax.php"],history:[],history2:[],tryProxies:async function(url,pos){return new Promise((resolve,reject)=>{const xhr=new XMLHttpRequest();const withProxy=FREEGPT.proxies[pos]+encodeURIComponent(url);xhr.open("GET",withProxy);xhr.onload=function(){if(xhr.status!==200){if(pos===FREEGPT.proxies.length-1){resolve(null)}resolve(FREEGPT.tryProxies(url,pos+1))}else{let res=xhr.response;if(pos===1){res=JSON.parse(res).contents}FREEGPT.proxyUsed=pos;resolve(res)}};xhr.onerror=function(){if(pos===FREEGPT.proxies.length-1){resolve(null)}resolve(tryProxies(url,pos+1))};xhr.send()})},process1:async function(query){const content=[...FREEGPT.history,{role:"user",content:query}];FREEGPT.history=content;const body={messages:content};const petition=await fetch(FREEGPT.APIS[0],{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(body)});if(petition.ok){const response=await petition.json();if(response.choices&&response.choices[0].message.content){const answer=response.choices[0].message.content;FREEGPT.history.push({role:"assistant",content:answer});return answer}}},process2:async function process2(query){let answer=await new Promise((resolve,reject)=>{const xhr=new XMLHttpRequest();const url=FREEGPT.proxies[FREEGPT.proxyUsed]+encodeURIComponent(FREEGPT.APIS[1]);const url2="https://chatgptspanish.org";xhr.open("POST",url);xhr.onerror=function(){throw new Error(xhr.status)};xhr.onload=function(){let res=JSON.parse(xhr.response);if(FREEGPT.proxyUsed===1){res=JSON.parse(res.contents)}FREEGPT.history2.push([query,res.data]);resolve(res.data)};const data=new FormData();data.append("_wpnonce","cc9fc8b04b");data.append("post_id","44");data.append("url",url2);data.append("action","wpaicg_chat_shortcode_message");let message="";if(FREEGPT.history2.length>0){message="We've interacted before, let me put you in context:";FREEGPT.history2.forEach(arr=>{message+="\nI wrote: "+arr[0];message+="\nYou answered: "+arr[1]});message+="\n Now I want to follow the conversation:\n"}message+=query;data.append("message",message);data.append("bot_id","0");xhr.send(data)});return answer},talk:async function(query,process){return new Promise(async function(resolve,reject){let ans;let errorLog;let givenError=false;try{if(typeof process!=="number"||process===1){ans=FREEGPT.process1(query)}else if(process===2){ans=FREEGPT.process2(query)}else{throw new Error("FREEGPT\n\nUnknown number of process: "+process)}}catch(err){givenError=true;errorLog=err}finally{if(!givenError){resolve(ans)}else{console.error(errorLog);resolve(undefined)}}})}};